(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9960,        301]
NotebookOptionsPosition[      9302,        274]
NotebookOutlinePosition[      9676,        290]
CellTagsIndexPosition[      9633,        287]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"u1", "=", "u01"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"v1", "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]1", "=", "\[Rho]01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", "p01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u2", "=", 
   RowBox[{"u02", "+", 
    RowBox[{"\[CurlyEpsilon]", "*", "uu2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"v2", "=", 
   RowBox[{"\[CurlyEpsilon]", "*", "vv2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]2", "=", 
   RowBox[{"\[Rho]02", "+", 
    RowBox[{"\[CurlyEpsilon]", "*", "\[Rho]\[Rho]2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"p02", "+", 
    RowBox[{"\[CurlyEpsilon]", "*", "pp2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nstrok", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "*", "m", "*", "\[CurlyEpsilon]", "*", 
        RowBox[{"\[Xi]", "/", "R1"}]}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nstolb", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "*", "m", "*", "\[CurlyEpsilon]", "*", 
        RowBox[{"\[Xi]", "/", "R1"}]}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "*", "\[Omega]", "*", 
        "\[CurlyEpsilon]", "*", "\[Xi]"}], "0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearizeSingleEquation", "[", 
    RowBox[{"eq_", ",", "baseVars_", ",", "pertVars_", ",", "eps_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{"eq", ",", 
          RowBox[{"{", 
           RowBox[{"eps", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
       "eps"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.968728350615714*^9, 3.968728534700616*^9}, {
  3.9687285957330885`*^9, 3.9687287121586695`*^9}, {3.9687289038707747`*^9, 
  3.9687289040268197`*^9}, {3.968729286288231*^9, 3.9687292998008075`*^9}, {
  3.968729629282488*^9, 3.9687296487481422`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{"p1", "+", 
    RowBox[{"\[Rho]1", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"u1", "v1"}
            }], "\[NoBreak]", ")"}], "-", "W"}], ")"}], ".", "nstolb"}], 
       ")"}], "^", "2"}]}], "-", "p2", "-", 
    RowBox[{"\[Rho]2", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"u2", "v2"}
            }], "\[NoBreak]", ")"}], "-", "W"}], ")"}], ".", "nstolb"}], 
       ")"}], "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result1", "=", 
   RowBox[{
    RowBox[{"LinearizeSingleEquation", "[", 
     RowBox[{"eq1", ",", 
      RowBox[{"{", 
       RowBox[{
       "u01", ",", "\[Rho]01", ",", "p01", ",", "u02", ",", "\[Rho]02", ",", 
        "p02"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"uu2", ",", "\[Rho]\[Rho]2", ",", "pp2", ",", "\[Xi]"}], "}"}],
       ",", "\[CurlyEpsilon]"}], "]"}], "*", "r"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.968728733856645*^9, 3.9687288691970873`*^9}, {
  3.96872893610953*^9, 3.9687289448885746`*^9}, {3.9687289750009594`*^9, 
  3.9687290324095373`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["eq1"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"p01", "-", "p02", "-", 
    RowBox[{"pp2", " ", "\[CurlyEpsilon]"}], "+", 
    RowBox[{"\[Rho]01", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"u01", "+", 
        RowBox[{
        "\[ImaginaryI]", " ", "\[CurlyEpsilon]", " ", "\[Xi]", " ", 
         "\[Omega]"}]}], ")"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Rho]02", "+", 
       RowBox[{"\[CurlyEpsilon]", " ", "\[Rho]\[Rho]2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"u02", "+", 
        RowBox[{"uu2", " ", "\[CurlyEpsilon]"}], "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "m", " ", "vv2", " ", 
          SuperscriptBox["\[CurlyEpsilon]", "2"], " ", "\[Xi]"}], "R1"], "+", 
        RowBox[{
        "\[ImaginaryI]", " ", "\[CurlyEpsilon]", " ", "\[Xi]", " ", 
         "\[Omega]"}]}], ")"}], "2"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9687296546683493`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"p01", "-", "p02", "-", 
    RowBox[{"pp2", " ", "\[CurlyEpsilon]"}], "+", 
    RowBox[{"\[Rho]01", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"u01", "+", 
        RowBox[{
        "\[ImaginaryI]", " ", "\[CurlyEpsilon]", " ", "\[Xi]", " ", 
         "\[Omega]"}]}], ")"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Rho]02", "+", 
       RowBox[{"\[CurlyEpsilon]", " ", "\[Rho]\[Rho]2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"u02", "+", 
        RowBox[{"uu2", " ", "\[CurlyEpsilon]"}], "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "m", " ", "vv2", " ", 
          SuperscriptBox["\[CurlyEpsilon]", "2"], " ", "\[Xi]"}], "R1"], "+", 
        RowBox[{
        "\[ImaginaryI]", " ", "\[CurlyEpsilon]", " ", "\[Xi]", " ", 
         "\[Omega]"}]}], ")"}], "2"]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.96872935542839*^9, 3.968729392747527*^9}, 
   3.9687296624946394`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p01", "-", "p02", "+", 
     RowBox[{
      SuperscriptBox["u01", "2"], " ", "\[Rho]01"}], "-", 
     RowBox[{
      SuperscriptBox["u02", "2"], " ", "\[Rho]02"}]}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pp2"}], "-", 
      RowBox[{"2", " ", "u02", " ", "uu2", " ", "\[Rho]02"}], "-", 
      RowBox[{
       SuperscriptBox["u02", "2"], " ", "\[Rho]\[Rho]2"}], "+", 
      RowBox[{
      "2", " ", "\[ImaginaryI]", " ", "u01", " ", "\[Xi]", " ", "\[Rho]01", 
       " ", "\[Omega]"}], "-", 
      RowBox[{
      "2", " ", "\[ImaginaryI]", " ", "u02", " ", "\[Xi]", " ", "\[Rho]02", 
       " ", "\[Omega]"}]}], ")"}], " ", "\[CurlyEpsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[CurlyEpsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[CurlyEpsilon], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[CurlyEpsilon], 
   0, {$CellContext`p01 - $CellContext`p02 + $CellContext`u01^2 $CellContext`\
\[Rho]01 - $CellContext`u02^2 $CellContext`\[Rho]02, -$CellContext`pp2 - 
    2 $CellContext`u02 $CellContext`uu2 $CellContext`\[Rho]02 - \
$CellContext`u02^2 $CellContext`\[Rho]\[Rho]2 + 
    Complex[0, 
       2] $CellContext`u01 $CellContext`\[Xi] $CellContext`\[Rho]01 \
$CellContext`\[Omega] + 
    Complex[0, -2] $CellContext`u02 $CellContext`\[Xi] $CellContext`\[Rho]02 \
$CellContext`\[Omega]}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.9687293701278906`*^9, 3.9687293944346685`*^9}, 
   3.9687296645098085`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "pp2"}], "-", 
     RowBox[{"2", " ", "u02", " ", "uu2", " ", "\[Rho]02"}], "-", 
     RowBox[{
      SuperscriptBox["u02", "2"], " ", "\[Rho]\[Rho]2"}], "+", 
     RowBox[{
     "2", " ", "\[ImaginaryI]", " ", "u01", " ", "\[Xi]", " ", "\[Rho]01", 
      " ", "\[Omega]"}], "-", 
     RowBox[{
     "2", " ", "\[ImaginaryI]", " ", "u02", " ", "\[Xi]", " ", "\[Rho]02", 
      " ", "\[Omega]"}]}], ")"}], ")"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.9687294326351557`*^9, 3.96872943566486*^9}, 
   3.9687296726016626`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "pp2"}], "-", 
  RowBox[{"u02", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "uu2", " ", "\[Rho]02"}], "+", 
     RowBox[{"u02", " ", "\[Rho]\[Rho]2"}]}], ")"}]}], "+", 
  RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Xi]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"u01", " ", "\[Rho]01"}], "-", 
     RowBox[{"u02", " ", "\[Rho]02"}]}], ")"}], " ", "\[Omega]"}]}]], "Output",
 CellChangeTimes->{3.968729436648958*^9, 3.9687296739607134`*^9}]
}, Open  ]]
},
WindowSize->{2048, 1069},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.8 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2439, 68, 523, "Input"],
Cell[3000, 90, 1316, 38, 89, "Input"],
Cell[CellGroupData[{
Cell[4341, 132, 29, 0, 54, "Input"],
Cell[4373, 134, 982, 26, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5392, 165, 1113, 29, 128, InheritFromParent],
Cell[6508, 196, 1610, 39, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8155, 240, 628, 16, 86, "Input"],
Cell[8786, 258, 500, 13, 87, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

